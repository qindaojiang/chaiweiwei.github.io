<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>vivi的蜡笔小男神</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="vivi的蜡笔小男神">
<meta property="og:url" content="https://github.com/chaiweiwei/index.html">
<meta property="og:site_name" content="vivi的蜡笔小男神">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="vivi的蜡笔小男神">
<meta name="twitter:description">
  
    <link rel="alternate" href="/atom.xml" title="vivi的蜡笔小男神" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">vivi的蜡笔小男神</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="Flux RSS"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Rechercher"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://github.com/chaiweiwei"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-newyear" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/02/23/newyear/" class="article-date">
  <time datetime="2016-02-23T08:03:14.000Z" itemprop="datePublished">2016-02-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/23/newyear/">新年开篇日</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这个年过的不开心，刚好也来了个“开年红”，年前比较忙，到了一个新公司，本来是想着先熟悉一下代码，需求还不需要跟上，但是好像内容堆的比较多，同一个iOS小伙伴每天加班加点的，我也有抓紧步伐跟上了，希望年前能提一版，因为iOS小伙伴是远程办公的，我感觉交流还是有一点不习惯，为了快速完成需求，并没有很仔细的阅读VC，找到重点就开始写了，好在还是年前完成期望的目标了，但是其中还是有很多不安因素，因为我们两个iOS开发水平差不多（哈哈），遇到问题要自己花相对较长的时间去查找，如果下班review前还没有解决好问题，想想也是有点小紧张呢。</p>
<p>之前有一个社区分享的需求，在原有基础上增加一个QQ空间的分享,之前的代码在使用第三方的时候很多都是自己手动配置的，没有使用cocoapod，因为之前的社区分享SDK用的是shareSDK，看上去已经是很久之前的版本了，现在要重新更新SDK，想想也是有点小紧张呢，因为用的是简洁版的，官方也建议使用简介版的，等替换build成功，老的shareSDK的很多方法基本都被替换了，坑爹的来了：</p>
<ol>
<li>QQ的开发者账号找不到了，只有key，没有秘钥，之前在记录的时候只记了key，这样使用shareSDK帮我集成好的方式就不使用与QQ第三方登录了，因为shareSDK的第三方登录需要两个参数，分享只需要一个，但是使用QQ原生的方式是不需要的，除了分享，第三方登录时使用原生的方式解决的。</li>
<li>跳转后发现跳转不会客户端，iOS9.0一下是可以的，但是iOS9以上会收不到回调，检查了很多，花了很长时间，也检查了error message，后来是因为我忽略了一个很重要的message：<strong>retryHandleOpenURL</strong>，当我使用客户端跳转登录成功后，回调失败就回有这个问题，具体是看了这一片<a href="http://www.jianshu.com/p/3ce4561ae7be" target="_blank" rel="external">blog</a>,想我没有去看SDK更新习惯的（是个不太好的习惯，有点被动），发现有个接收回调的方法在新的SDK中被替换了</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application openURL:(<span class="built_in">NSURL</span> *)url sourceApplication:(nullable <span class="built_in">NSString</span> *)sourceApplication annotation:(<span class="keyword">id</span>)annotation <span class="built_in">NS_DEPRECATED_IOS</span>(<span class="number">4</span>_2, <span class="number">9</span>_0, <span class="string">"Please use application:openURL:options:"</span>) __TVOS_PROHIBITED;</span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)app openURL:(<span class="built_in">NSURL</span> *)url options:(<span class="built_in">NSDictionary</span>*)options <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0); <span class="comment">// no equiv. notification. return NO if the application can't open for some reason****</span></span><br></pre></td></tr></table></figure>
<ol>
<li>微信分享失败这个是K.O了我啊，就他比较特别，因为我们的内容图片可能比较大，超过了最大的图片限制，后台没有区分小图和大图的字断，分享的时候携带的都是大图，之前开发者在写图片压缩的方法的时候只是缩小了图片的尺寸，像素值没有改变，大小还是一样的，内容可能远远大于限制大小了，但是我想吐槽的时候，微信平台分享失败（图片原因）没有任何提示，也不会跳转到微信客户端，就是没有反应，这样不是很揪心吗！而且搜不到没有任何的官方文档说具体的分享图片大小限制是多少。。。。。这个是shareSDK提供的方法，没有使用微信原生方式！</li>
</ol>
<p>虽然好像是两个人可以讨论，但是我感觉效率还是有点低，虽然遇到问题自己找到解决方法的时候很爽，除了在上新版本遇到的各色各样的问题，还是一个要吐槽的，我感觉这边的git使用没有很规范的感觉，使用的时候多少有点不适应。</p>
<p>年后除了新版本的上线事宜，要分析用户使用情况，降低crash率，之前没有使用过专门的统计工具bugly，我感觉使用还是可以的，但是还是感觉信息有点少，但是靠这个工具基本能解决百分之70左右的问题吧，争取把crash降低到0.2-0.5%左右吧，但是之前因为一个8.1版本的问题，导致了crash上升到了2.5%以上，宏观来看我感觉还是OK的，但是涉及到的用户还是多的，这个问题表现在有需要截图windows图像绘制的时候</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[window.layer renderInContext:context];</span><br></pre></td></tr></table></figure>
<p>网上的资料说<strong>renderInContext</strong>方法有几率会crash，但是在8.1系统下百分之白会crash，其他的系统（没有测全部）重现不出来，不知道是不是有这个问题。解决方法是用新方法代替：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[window drawViewHierarchyInRect:delegate.window.bounds afterScreenUpdates:<span class="literal">NO</span>];</span><br></pre></td></tr></table></figure>
<p>完美解决问题，<strong>drawViewHierarchyInRect</strong>会比<strong>renderInContext</strong>方法执行时间慢一点点，但是我们肉眼感觉不到几毫秒的差别。等新版本上线，在观察crash有没有下降。<a href="http://newtips.co/st/questions/33592307/what-is-expected-performance-of-drawviewhierarchyinrect-vs-renderincontext.html" target="_blank" rel="external">相关的参考链接</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chaiweiwei/2016/02/23/newyear/" data-id="cilal5cvp000mjjs69uaw0xw5" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-new-work" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/29/new-work/" class="article-date">
  <time datetime="2016-01-29T08:03:14.000Z" itemprop="datePublished">2016-01-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jekyll-update/">jekyll update</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/29/new-work/">2016 new work</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>又隔了好久才更新的内容，最近忙的事情有两件：新工作，新项目上线.</p>
<p>就在前不久因为不可抗拒的原因上个月离开了原来的公司，很多不舍吧，因为事情突然，都临近年关了，因为性子比较急，想要在年前能稳定下来，而不是过年回家了还处在失业的状态，多少有点心里不安，要知道工作可能过年家人必问的问题啊。</p>
<p>现在想想自己还是”<strong>too young too simple</strong>“，当时2个星期左右吧，我都是在火急火燎的投简历，希望尽快有人能联系我，但是发现现在iOS怎么难找工作了，好像竞争很激烈的样子，等了好久只有几家有回应，生理和心理都承受着莫大的压力啊，怎么说呢，虽然师傅对我有信心，希望我能等一等，找个合心意的，但是自己好像就是缺少那么点自信的样子，总感觉有人要我就不错了，虽然我现在有两份工作的经验，但是我是2015年的毕业生，在这个坎上也被不少HR嫌弃了，面的多了，除了项目上的东西，发现基础概念还有很多慢慢的被遗忘了，有种就在喉咙，就是吐不出来的感觉（还是读书少啊！），一边面试，一边补充内容，我看时间差不多了，再推迟就真的只能过完年再弄了。</p>
<p>当下有收到了三个offer，第一个是外包公司，我心里还是抵触的，怕学习到的东西不多，后来在多方努力下，接到了一个传化物流的面试通知，我还是很看重的，因为是大公司，自己内心还是很希望自己能进的，所以表现的很积极，准备的也还可以，这个也是我最想吐槽的，希望越大，失望越大，没错，不管是初试还是复试，我表现的好像还可以，HR和技术官好像都对好相对较满意的样子，我也很兴奋啊，感觉offer到手了的感觉，因为是大公司，我感觉字啊待遇方面一定是不会亏待小辈的，按能力分配吧，本来和HR说好的是年薪XX，这个还是HR说看在我是应届生的份上能给的最多了，心当下就凉了，因为和我提的期望薪资还是有蛮大差距的，但是因为心中的“执念”，还想说要不试试，除了公司是上市外，iOS团队人数也够，技术团队是过硬的，我还想说当交学费学习了，把心吊着接受了offer，最最坑爹的就是晚上HR给我打了个电话，说是在给副总签字的时候，发现我是应届生，说什么我的薪资比公司上届着的应届生要高，副总可能会考虑这个情况，会在说好的年薪上降低2W左右。。。当时我的心啊，后来在参考师父的意见后，我依然拒绝了传化的offer，这次着工作给我体验最深的就是别人拿我是应届生的问题说事情了，对了，还有我是女程序员，应届生没错，但是我也有快1年是正式工作经验了，说女生不好加班，晕死，一直加班的公司老娘还不想去呢（被师父胃口养刁了！）。当时在传化复试后又一个半次元的面试，本来想说既然有自己相对中意的offer，要不然就不要去面试了，感觉很疲惫的样子，现在想来，幸亏去了，因为这家是我现在在职的新东家，我虽然不是一个腐女，但是是一个宅女，也希望动漫（蜡笔小新是我男神！），当时收到面试通知的时候超级兴奋的，能参与进来。因为当时有两个offer了，心里比较有底了，说实话，面试面的有点高冷的，哈哈，没有特别上心，现在想想，这样反而放松了，本来说要等一星期再通知结果的，晚上给HR发了消息表述了希望能尽快得到回复，哪知道隔天就收到offer了，哈哈，要知道我当时还和师父在商量传化的offer，这下好了，当然是去<strong>半次元</strong>啊，一不小心走上了和弟弟一样的道路呢（别提他有多高兴了呢）。</p>
<p>这次找工作的经历是我这三次找工作中最辛苦的，本来想说这小半辈子都过的很平顺呢，哪知道老天给我绊了一脚。现在想想还是太年轻太浮躁呢。</p>
<p>每次到新的公司看到新的项目都能学到很多新的开发思路和方法，如果一直呆在同一个公司，最初的进步是大的，慢慢的曲线就会下滑，需要不断的吸收新的东西，不过每次新的工作最烦的就是要有新的交际圈子，哎！明天双休啦，终于结束一周每天2小时上下班的“美好”时光啦。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chaiweiwei/2016/01/29/new-work/" data-id="cilal5cvn000kjjs6vp1d0ve1" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-jspatch" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/29/jspatch/" class="article-date">
  <time datetime="2015-12-29T08:03:14.000Z" itemprop="datePublished">2015-12-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jekyll-update/">jekyll update</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/29/jspatch/">JSPatch问题总结</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>至今使用JSPatch修了两三个bug了，一开始用还有点小紧张呢，写的会比较慢，发现问题后，我的处理顺序是先在oc代码中把问题解决好，这时候开始意识到自己代码封装上的缺点了，代码块时不时超过50行，函数名有待改进什么的，现在在写功能的时候都会不自觉的去检查函数有没有查过一屏，51行也扣成50行，哈哈（任性），不想给以后留坑，特别是现在接着JSPatch的便利好好整顿一下自己的代码，hotfix之后，用JSPatch Convert工具粗略的转换一下，这个工具不是百分百正确的，但是能帮助转换一些简单繁琐的代码，一些数组、字典、block什么的还是要自己好好的检查，<a href="https://github.com/bang590/JSPatch/wiki">JSPatch的wiki</a>就要常翻阅了， 反正遇到要转换block的时候就要去找一找，还有一些特殊的结构体，wiki都在不断的更新当中。</p>
<p>这里总结一下我这几次遇到的问题：</p>
<h3 id="动态增加property"><a href="#动态增加property" class="headerlink" title="动态增加property"></a>动态增加property</h3><p>这个知识点很重要的:<a href="https://github.com/bang590/JSPatch/wiki/defineClass使用文档">wiki</a>,要新增成员变量只能通过<code>setProp_forKey()</code>,并且该成员变量只能使用<code>getProp()</code>来获取，不像OC中定义的已经定义好的Property，可以直接用 <code>get set</code>方法获取，详细的可以阅读wiki中的段落，这边我遇到的问题是，我需要A类和B类push操作的时候，带一个type的类型来区分，当时是抱着测试的目的在写js的，所以只defineclass了A类型，一调试，果然是有问题的，代码姑且如下：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">defineClass(<span class="string">"A"</span>, &#123;</span><br><span class="line"></span><br><span class="line">  shareToChat: function() &#123;</span><br><span class="line">    var A = A.alloc().init();</span><br><span class="line"></span><br><span class="line">    A.setDelegate(<span class="keyword">self</span>);</span><br><span class="line"></span><br><span class="line">    A.setModel(<span class="keyword">self</span>.model());</span><br><span class="line"></span><br><span class="line">    A.setProp_forKey(<span class="number">1</span>,<span class="string">"type"</span>);</span><br><span class="line"></span><br><span class="line">    var navigationController = <span class="built_in">UINavigationController</span>.alloc().initWithRootViewController(A);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.presentViewController_animated_completion(navigationController, <span class="literal">YES</span>, null);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>我当时想的crash的地方可能还是出在了setProp_forKey上面，可能不允许我在两个类中切换，但是一定要实现这个问题，想着有公司还用JSPatch来做一整个app呢，我这个应该还是我自己的问题，<code>getProp()</code>还没写，想说等一下把defineclassA测试OK了再写B，这个就为我填坑埋下了伏笔啊。调试中一直提示找不到 <code>setProp_forKey（）</code>方法，折腾了好久，百般无奈只有求助了，在JSPatch群中求助，得到的结果是：</p>
<p><code>js文件中只有define过的class才能使用setProp_forKey()和getProp()</code>，这边注意的是A没有define，JSPatch源码中有描述：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="built_in">NSDictionary</span> *defineClass(<span class="built_in">NSString</span> *classDeclaration, JSValue *instanceMethods, JSValue *classMethods) &#123;</span><br><span class="line">  .......</span><br><span class="line">  .......</span><br><span class="line"></span><br><span class="line">  <span class="meta">#pragma clang diagnostic push</span></span><br><span class="line">  <span class="meta">#pragma clang diagnostic ignored <span class="meta-string">"-Wundeclared-selector"</span></span></span><br><span class="line">      class_addMethod(cls, <span class="keyword">@selector</span>(getProp:), (IMP)getPropIMP, <span class="string">"@@:@"</span>);</span><br><span class="line">      class_addMethod(cls, <span class="keyword">@selector</span>(setProp:forKey:), (IMP)setPropIMP, <span class="string">"v@:@@"</span>);</span><br><span class="line">  <span class="meta">#pragma clang diagnostic pop</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> @&#123;<span class="string">@"cls"</span>: className&#125;;</span><br><span class="line">  .......</span><br><span class="line">  .......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这部分在wiki中没有提到过，我以为没有看过源码，也没有在意，很理所当然的就发生的bug了，好在在理解后顺利解决了问题</p>
<h3 id="括号"><a href="#括号" class="headerlink" title="括号"></a>括号</h3><p>我作为一个初学者总是被要不要()弄的晕头转向的，因为js里面不认识property属性，除了调用getter，没有办法获取property，比如：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[<span class="keyword">self</span> model] -&gt; <span class="keyword">self</span>.model()</span><br></pre></td></tr></table></figure>
<p>所有的方法 js都得加括号,.xxx()的意思就是 调用方法，但是如果model已经传值给了var，则不需要再加()</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> model = self.model()</span><br><span class="line">model.name()</span><br></pre></td></tr></table></figure>
<h3 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h3><p>在调试的时候通常使用safari，有一点需要注意的是，当希望debug查看值的时候，光<code>console.log</code>没有用,需要将object转换成js:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jsstr = ocstr.toJS()</span><br></pre></td></tr></table></figure>
<p>不然输出都是object.object。</p>
<h3 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h3><p>JSPatch不支持可变参数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> string = NSString.stringWithFormat(<span class="string">"chat:%"</span>, self.model().groupID())</span><br></pre></td></tr></table></figure>
<p>string是不能正确赋值的，需要使用<code>+</code>连接字符串</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> string = <span class="string">"hello "</span> + self.model().name().toJS()</span><br></pre></td></tr></table></figure>
<h3 id="block中self的引用"><a href="#block中self的引用" class="headerlink" title="block中self的引用"></a>block中self的引用</h3><p>在block中声明self或者其他的强引用和弱引用比objc中严格，objc中就是warning，但是js中会影响效果的实现，该用strongSelf的时候不要再使用self。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> weakSelf = __weak(self)</span><br><span class="line"><span class="keyword">var</span> strongSelf = __strong(weakSelf);</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chaiweiwei/2015/12/29/jspatch/" data-id="cilal5cvg000djjs6ciknfkfs" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-disanfangjiehuan" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/12/disanfangjiehuan/" class="article-date">
  <time datetime="2015-12-12T04:03:14.000Z" itemprop="datePublished">2015-12-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jekyll-update/">jekyll update</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/12/disanfangjiehuan/">第三方App切换</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>我们现在的求攻略系列的app就有64个，现在有新增的离线地图和三个国家攻略，国家攻略主要是我在制作，其实也就是在本来的基础上增加target，要小心注意的info文件和URL type的信息修改。我就在这里又不小心跌了一跤。</p>
<p>我们的app有一个分享跳转的问题，主要出现在tencent的sdk上，当分享切换的时候不能准确的回到原先的app，这里设置了几个URL type，外部可以通过设置的scheme来启动app，拿新浪和QQ来说，这两个主要用在了第三方登录上：</p>
<table>
<thead>
<tr>
<th>name</th>
<th>URL type</th>
</tr>
</thead>
<tbody>
<tr>
<td>sina</td>
<td>sinaweibo+Bundle name</td>
</tr>
<tr>
<td>qq</td>
<td>tencent+(key)100274236</td>
</tr>
</tbody>
</table>
<p>上面列出的规则就能发现新浪的标识肯定是不会出现跳转混乱的问题的，但是QQ的URL，因为我们分攻略的数量太多了，针对一个app去申请1个可以好像有一点点不合理呢，所以这个key可能是4、5个app共用的。</p>
<p>为了解决这个问题，解决方案就是当是QQ登录的时候使用web版，不跳转到QQ App,新浪的第三方登录就没有关系，但我在创建韩国、日本、泰国攻略三个国家攻略的时候没有去设置info.plist文件，以为target是copy过来的，新浪的scheme还保留了：sinaweibo＋(old).</p>
<p>分析问题才能解决问题啊。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chaiweiwei/2015/12/12/disanfangjiehuan/" data-id="cilal5cve000bjjs63t9xt9xi" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-zidingyiqiehuan" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/04/zidingyiqiehuan/" class="article-date">
  <time datetime="2015-12-04T04:03:14.000Z" itemprop="datePublished">2015-12-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jekyll-update/">jekyll update</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/04/zidingyiqiehuan/">自定义切换</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>昨天无意间在玩耍新版“花瓣app”的时候，发现了一个之前没有看到过的控制器切换的效果（主要也是因为自己的知识储备不够），点击花瓣的瀑布流式cell,新的控制器是从点击位置放大直填充屏幕，展示一个新的控制器界面。还有添加了一个手势，当在新界面做左右手势的时候，展示的是上一个/下一个cell详情。总的来说使用的还是挺流畅的，当时我就想也尝试一个，但是不知道是怎么实现的，其实在iOS7中已经支持了：自定义切换。我是在search一个<a href="http://onevcat.com/2013/10/vc-transition-in-ios7/" target="_blank" rel="external">大神的blog</a>的时候发现的。今天就花了点时间好好整理了一下，主要是分成两种情况和API，代码在我几近折腾的情况下提交上了<a href="https://github.com/chaiweiwei/CustomPresentationDemo">Github</a>：</p>
<p>1.demo中只展示了对于modalVC的present和dismiss的自定义切换效果:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UIViewControllerTransitioningDelegate</span><br></pre></td></tr></table></figure>
<p>2.Navigation Controller的Push和Pop切换:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UINavigationControllerDelegate</span><br></pre></td></tr></table></figure>
<p>PS:这里要提及的是iOS8在iOS7的基础上增加了一个API：UIPresentationController，我也将其整理到项目中。</p>
<p><a href="https://www.objc.io/issues/5-ios7/view-controller-transitions/" target="_blank" rel="external">UINavigationController Push And Pop参考链接</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chaiweiwei/2015/12/04/zidingyiqiehuan/" data-id="cilal5cvv000ujjs692sgjrt1" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-otocpressfangqi-Jekyllgengshang" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/03/otocpressfangqi-Jekyllgengshang/" class="article-date">
  <time datetime="2015-12-03T06:02:14.000Z" itemprop="datePublished">2015-12-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jekyll-update/">jekyll update</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/03/otocpressfangqi-Jekyllgengshang/">otocpress放弃  Jekyll跟上</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="otocpress-填坑"><a href="#otocpress-填坑" class="headerlink" title="otocpress 填坑"></a>otocpress 填坑</h3><p>之前blog关闭了一段时间，一位otocpress搭建的环境坏了，一直generate 失败，多少有点打击积极性的，后来一直在写还是不写中纠结，前几天一直在网上搜罗修复问题，因为mac系统升级EI，有一些环境需要更新，这边有一个比较大，也是经常出现的问题，因为网上能搜罗到（哈哈哈）：</p>
<p>1.octopress Errno::ENOENT: No such file or directory - compass:<br>这个问题找了好久，我这边问题出现的原因是ruby需要更新成2.2.3，<code>ruby --v</code>显示仍然是2.2.0</p>
<p>解决方案：</p>
<pre><code>brew update
rvm install ruby-2.2.3
</code></pre><p>重新查看<code>ruby --version</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby 2.2.3p173 (2015-08-18 revision 51636) [x86_64-darwin14]</span><br></pre></td></tr></table></figure>
<p>这里提供了一个<a href="http://schalkneethling.github.io/blog/2015/10/16/errno-enoent-no-such-file-or-directory-jekyll-octopress-el-capitan/" target="_blank" rel="external">参考链接</a>但是它提供的参考命令我这边部分没有效果，都是一点点折腾。</p>
<p>当<code>rake generate</code>成功后好兴奋啊，<code>rake preview</code>查看本地4000，完美，但是一个坑又来了，当我导入之前写的blog的时候，出现了一个大bug，导致我之后还是选择Jeklly：</p>
<p>2.Pygments can’t parse unknown language:</p>
<p>有的人说是因为python要更新成3.5最新，有的人说当python版本是3.＊的时候会出现这个问题，要将python降成2.＊,反正就是有各种的问题，导致我的otocpress环境还是搭建不成功，不知道是这几天的杭州雾霾还是因为要修复blog让我头重脚轻的。</p>
<h3 id="Jekyll环境搭建"><a href="#Jekyll环境搭建" class="headerlink" title="Jekyll环境搭建"></a>Jekyll环境搭建</h3><p>Jekyll安装起来是很简单的，但是当我将源文件上传github的时候，发现<code>Jekyll preview</code>预览时OK的，但是<a href="http://chaiwiewei.github.io总是404，当我仔细检查提交记录的时候发现就是没有index.html文件，没有首页。真的好奇怪，一直没有找到原因，我用了sourcetree工具也试了，命令的方式" target="_blank" rel="external">http://chaiwiewei.github.io总是404，当我仔细检查提交记录的时候发现就是没有index.html文件，没有首页。真的好奇怪，一直没有找到原因，我用了sourcetree工具也试了，命令的方式</a> <code>git add</code>也试了，index.html在目录下就是不能提交上，像一个幽灵文件一下，好吧，一定要强制add <code>git add -f index.html</code>,结局是好的，就是不知道是什么原因引起的。现在正在紧锣密鼓的将记录在本地的问题整理到blog上呢。。。。。。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chaiweiwei/2015/12/03/otocpressfangqi-Jekyllgengshang/" data-id="cilal5cvm000ijjs6exiv2h8l" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Autolayout_Animation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/03/Autolayout_Animation/" class="article-date">
  <time datetime="2015-12-03T04:03:14.000Z" itemprop="datePublished">2015-12-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jekyll-update/">jekyll update</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/03/Autolayout_Animation/">Autolayout Animation</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/assets/search_animation.gif" alt="setting"></p>
<p>我一直都感觉动画是我的一个薄弱点，因为现在都是用Autolayout来布局，要做动画之前的方式使用frame已经不生效了，现在在做国家攻略的时候要做一个随着scrollerView滑动，搜索栏变形的动画，如果需要pop动画的话是可以用 <code>POP</code>做，但是我感觉从椭圆变形成圆形，原点不变，就是frame的width在变化，没有必要用pop，之前在尝试利用Autolayout做动画一直失败的原因是，无论我怎么变化约束，对象view都不变化，这次终于成功了，也找到了我一直以来的问题，先上代码：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[<span class="keyword">self</span>.searchButton mas_updateConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">            make.width.and.height.mas_equalTo(<span class="number">100</span>);</span><br><span class="line">        &#125;];     </span><br><span class="line">        [<span class="built_in">UIView</span> animateWithDuration:<span class="number">3</span> animations:^&#123;</span><br><span class="line">    [<span class="keyword">self</span>.view layoutIfNeeded];</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>这个理解是通过update button的宽约束来做一个3s的动画，[self.view layoutIfNeeded];是一个重点，包含两个知识点:</p>
<ol>
<li><p>Autolayout中容易混淆的地方：setNeedsLayout、layoutIfNeeded、layoutSubViews：<a href="http://www.vienta.me/2015/05/18/AutoLayout-浅析动画（III）/" target="_blank" rel="external">很好的参考资料</a></p>
</li>
<li><p>在autolayout下，主要是利用约束，动画的本质实际上是从一种约束状态变成另一种约束状态，从而来达到动画的目的。button转换过来的frame是相对于self.view，所以是self.view中有约束变化的时候，重新绘制自动布局。</p>
</li>
</ol>
<p>我之前的问题就是一直是以self.button为对象在更新约束的，现在想来都在做无用功。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chaiweiwei/2015/12/03/Autolayout_Animation/" data-id="cilal5cv30006jjs6zi38vr4x" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Title-qubie" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/03/Title-qubie/" class="article-date">
  <time datetime="2015-12-03T04:03:14.000Z" itemprop="datePublished">2015-12-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jekyll-update/">jekyll update</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/03/Title-qubie/">Title的区别</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="self-title"><a href="#self-title" class="headerlink" title="self.title"></a>self.title</h3><p>重中之重，之前在学习的时候都没有发现这个小细节，self.navigationItem.title，self.tabBarItem.title，self.title的区别。一般设置nav Controller的title的时候就直接使用self.title，这是完全能满足需求的，但是随着app项目的“复杂”化，比如这里需要tabbar的title是“动态”，但是当前的nav controller的title钥匙“普吉岛”，我但是也没细想啊<code>self.title=@&quot;普吉岛&quot;</code>不就好了，但是发现tabbar的title从动态也变成“普吉岛”，原来是因为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当self.navigationItem.title，self.tabBarItem.title没有赋值情况下值和self.title一致。</span><br></pre></td></tr></table></figure>
<p>解决方案:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.title = @&quot;Title for TabBarItem&quot;; // TabBarItem.title inherits the viewController&apos;s self.title</span><br><span class="line">self.navigationItem.title = @&quot;Title for NavigationBar&quot;;</span><br></pre></td></tr></table></figure>
<p><a href="http://stackoverflow.com/questions/1540718/self-title-sets-navigationcontroller-and-tabbaritems-title-why" target="_blank" rel="external">参考链接</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chaiweiwei/2015/12/03/Title-qubie/" data-id="cilal5cvc0009jjs6qo0k1tn5" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Translucent-TabBar" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/03/Translucent-TabBar/" class="article-date">
  <time datetime="2015-12-03T04:03:14.000Z" itemprop="datePublished">2015-12-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jekyll-update/">jekyll update</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/03/Translucent-TabBar/">Translucent TabBar</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在修改tabbar icon的时候发现之前tabbar在translucent上的一个bug，现在新的icon底色是白色的，之前还能不理会这个问题，看上去问题不到，现在是白色的底色，问题就被放大了，在反复检查下发现是因为UITabBar的<code>translucent</code>属性造成的，现在当我将值设置为NO的时候，是能完美的解决icon的问题但是会造成一个比较严重的问题，因为app中有几个viewcontroller有<code>滑动动作tabbar展示的动画</code>，可以测试一下，当translucent=NO时，viewcontroller滑动，tabbar向下缩的时候会造成tabbar位置变成黑色背景了，tableView没有自动布局到地步，解决方案是</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">viewController.extendedLayoutIncludesOpaqueBars = <span class="literal">YES</span>;</span><br><span class="line">viewController.edgesForExtendedLayout = <span class="built_in">UIRectEdgeBottom</span>;</span><br></pre></td></tr></table></figure>
<p>属性<code>extendedLayoutIncludesOpaqueBars</code>可以从字面上翻译成延伸不仅包括透明的bar，我在<a href="http://stackoverflow.com/questions/20979281/ios-7-tabbar-translucent-issue" target="_blank" rel="external">参考链接</a>中看到一句话：</p>
<blockquote>
<p>This happens in iOS7 when you set tabBar.translucent to NO. iOS is trying to be smart and say “hey the tabbar is not translucent so we better push everything up on top of it”. Fix it by setting the extendedLayoutIncludesOpaqueBars property of the view controller inside the navigation controller which is inside the tabbar controller to YES.</p>
</blockquote>
<p>翻译成:</p>
<p>这样的情况会发生在iOS7中，当设置tabBar.translucent为NO, iOS试图自作聪明，认为这里的tabbar是不透明的，所以我们最好将所有的东西都推到顶部，修复这个问题是将在navigation controller中的view controller属性extendedLayoutIncludesOpaqueBars设置成YES</p>
<p>这样做就能将我们tabbar位置上黑色背景的问题修复好了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chaiweiwei/2015/12/03/Translucent-TabBar/" data-id="cilal5cvd000ajjs6bajruiz8" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-wikiri-bao-nei-rong-qian-yi" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/10/24/wikiri-bao-nei-rong-qian-yi/" class="article-date">
  <time datetime="2015-10-24T07:33:11.000Z" itemprop="datePublished">2015-10-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/日报/">日报</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/24/wikiri-bao-nei-rong-qian-yi/">wiki日报内容迁移</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>之前的工作日报是写在公司wiki上的，为了防治丢失现在移过来，都是前期在工作的时候遇到的小问题，总结了一下。</p>
        
          <p class="article-more-link">
            <a href="/2015/10/24/wikiri-bao-nei-rong-qian-yi/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chaiweiwei/2015/10/24/wikiri-bao-nei-rong-qian-yi/" data-id="cilal5cwd000wjjs6lmitwmb7" class="article-share-link">Partager</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Catégories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/jekyll-update/">jekyll update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/日报/">日报</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Articles récents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/02/23/newyear/">新年开篇日</a>
          </li>
        
          <li>
            <a href="/2016/01/29/new-work/">2016 new work</a>
          </li>
        
          <li>
            <a href="/2015/12/29/jspatch/">JSPatch问题总结</a>
          </li>
        
          <li>
            <a href="/2015/12/12/disanfangjiehuan/">第三方App切换</a>
          </li>
        
          <li>
            <a href="/2015/12/04/zidingyiqiehuan/">自定义切换</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 chaiweiwei~vivi<br>
      Propulsé by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>